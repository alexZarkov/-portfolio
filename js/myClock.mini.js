// @web-memory.ru 2014
$.fn.myClock=function(a){function g(e){str=e+"";2>str.length&&(e="0"+e);return e}function n(e,a,b){b=b||{};var c=b.expires;if("number"==typeof c&&c){var f=new Date;f.setTime(f.getTime()+1E3*c);c=b.expires=f}c&&c.toUTCString&&(b.expires=c.toUTCString());a=encodeURIComponent(a);e=e+"="+a;for(var g in b)e+="; "+g,a=b[g],!0!==a&&(e+="="+a);document.cookie=e}function k(a){return(a=document.cookie.match(new RegExp("(?:^|; )"+a.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(a[1]):
void 0}var b=$.extend({endDate:"0",endTime:"0",circle:"0",cookie:"0",cookieTime:"30",dateOff:"0",separDate:"",separTime:""},a),f=this;a="";1==b.dateOff&&(a+='<span class="block-clock"><span class="line"></span><span class="clock-date"></span></span>'+b.separDate);a+='<span class="block-clock"><span class="line"></span><span class="clock-hours"></span></span>'+b.separTime;a+='<span class="block-clock"><span class="line"></span><span class="clock-minutes"></span></span>'+b.separTime;a+='<span class="block-clock"><span class="line"></span><span class="clock-seconds"></span></span>';
$(f).html(a);var c=$(this).attr("id")?$(this).attr("id"):$(f).children().parent().attr("class");a=startDate=0!=b.endDate?new Date(b.endDate):new Date;var l=cookieTimeUTC=k(c)&&1==b.cookie?k(c):Math.floor(a.getTime()+6E4*b.endTime),p=6E4*a.getTimezoneOffset();1==b.cookie&&(k(c)||n(c,cookieTimeUTC,{expires:60*b.cookieTime}));stopClock=[];stopClock[c]||(stopClock[c]="0");var q=setInterval(function(){endTime=new Date;endTimeUTC=endTime.getTime();ostTime=new Date(l-endTime+p);d=Math.floor(ostTime.getDate()-
1);h=Math.floor(ostTime.getHours());m=Math.floor(ostTime.getMinutes());s=Math.floor(ostTime.getSeconds());l<=endTimeUTC+1E3&&(s=m=h=d="00",1==b.circle?l=Math.floor(endTimeUTC+6E4*b.endTime):(stopClock[c]="1",clearInterval(q)));1==b.dateOff&&$(f).children(".block-clock").children(".clock-date").html(g(d));$(f).children(".block-clock").children(".clock-hours").html(g(h));$(f).children(".block-clock").children(".clock-minutes").html(g(m));$(f).children(".block-clock").children(".clock-seconds").html(g(s))},
10);return stopClock};